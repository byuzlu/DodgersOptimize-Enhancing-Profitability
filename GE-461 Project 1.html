<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Bahadır Yüzlü">

<title>Spring 2024 GE 461 Project 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="GE-461 Project 1_files/libs/clipboard/clipboard.min.js"></script>
<script src="GE-461 Project 1_files/libs/quarto-html/quarto.js"></script>
<script src="GE-461 Project 1_files/libs/quarto-html/popper.min.js"></script>
<script src="GE-461 Project 1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="GE-461 Project 1_files/libs/quarto-html/anchor.min.js"></script>
<link href="GE-461 Project 1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="GE-461 Project 1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="GE-461 Project 1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="GE-461 Project 1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="GE-461 Project 1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><p>Spring 2024<br>
GE 461 Project 1</p></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Bahadır Yüzlü </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="project-description" class="level2">
<h2 class="anchored" data-anchor-id="project-description">Project Description</h2>
<p>The Dodgers is a professional baseball team and plays in the Major Baseball League. The team owns a 56,000-seat stadium and is interested in increasing the attendance of their fans during home games. At the moment the team management would like to know if bobblehead promotions increase the attendance of the team’s fans?</p>
</section>
<section id="initial-opinions" class="level2">
<h2 class="anchored" data-anchor-id="initial-opinions">Initial Opinions</h2>
<p>Bobbleheads may offer several benefits for the Dodgers, such as increasing attendance and boosting ticket sales, as well as fostering greater fan support which could enhance the team’s performance. However, there are potential drawbacks to consider. If bobblehead giveaways fail to attract more attendees, they could represent an unnecessary cost for the team. Moreover, there’s a risk that such promotions might attract collectors rather than genuine fans, potentially preventing the real fan support. While short-term financial gains are important, it’s crucial to consider a wider range of factors before making such critical decisions. For this various approaches such as survey analysis, attendance data examination, fan engagement metrics, feedback from season ticket holders, comparative analysis, revenue analysis should be explored. However, in this analysis, we’ll focus on only short-term financial gain and make a full regression analysis on the data.</p>
</section>
<section id="data-import" class="level2">
<h2 class="anchored" data-anchor-id="data-import">Data Import</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RSQLite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'RSQLite' was built under R version 4.2.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span><span class="fu">dbConnect</span>(<span class="fu">SQLite</span>(), <span class="st">"../s2024_week05/dodgers.sqlite"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListTables</span>(con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "events"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListFields</span>(con, <span class="st">"events"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "month"       "day"         "attend"      "day_of_week" "opponent"   
 [6] "temp"        "skies"       "day_night"   "cap"         "shirt"      
[11] "fireworks"   "bobblehead" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>d0 <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT * from events;"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>closeAllConnections</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function () 
{
    i &lt;- sink.number(type = "message")
    if (i &gt; 0L) 
        sink(stderr(), type = "message")
    n &lt;- sink.number()
    if (n &gt; 0L) 
        for (i in seq_len(n)) sink()
    gc()
    set &lt;- getAllConnections()
    set &lt;- set[set &gt; 2L]
    for (i in seq_along(set)) close(getConnection(set[i]))
    invisible()
}
&lt;bytecode: 0x000001cd3c044e58&gt;
&lt;environment: namespace:base&gt;</code></pre>
</div>
</div>
</section>
<section id="data-analysis-and-preprocess" class="level2">
<h2 class="anchored" data-anchor-id="data-analysis-and-preprocess">Data Analysis and Preprocess</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d0)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  month day attend day_of_week opponent temp  skies day_night cap shirt
1   APR  10  56000     Tuesday  Pirates   67  Clear       Day  NO    NO
2   APR  11  29729   Wednesday  Pirates   58 Cloudy     Night  NO    NO
3   APR  12  28328    Thursday  Pirates   57 Cloudy     Night  NO    NO
4   APR  13  31601      Friday   Padres   54 Cloudy     Night  NO    NO
5   APR  14  46549    Saturday   Padres   57 Cloudy     Night  NO    NO
6   APR  15  38359      Sunday   Padres   65  Clear       Day  NO    NO
  fireworks bobblehead
1        NO         NO
2        NO         NO
3        NO         NO
4       YES         NO
5        NO         NO
6        NO         NO</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>d0 <span class="sc">%&gt;%</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    month                day            attend      day_of_week       
 Length:81          Min.   : 1.00   Min.   :24312   Length:81         
 Class :character   1st Qu.: 8.00   1st Qu.:34493   Class :character  
 Mode  :character   Median :15.00   Median :40284   Mode  :character  
                    Mean   :16.14   Mean   :41040                     
                    3rd Qu.:25.00   3rd Qu.:46588                     
                    Max.   :31.00   Max.   :56000                     
   opponent              temp          skies            day_night        
 Length:81          Min.   :54.00   Length:81          Length:81         
 Class :character   1st Qu.:67.00   Class :character   Class :character  
 Mode  :character   Median :73.00   Mode  :character   Mode  :character  
                    Mean   :73.15                                        
                    3rd Qu.:79.00                                        
                    Max.   :95.00                                        
     cap               shirt            fireworks          bobblehead       
 Length:81          Length:81          Length:81          Length:81         
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            </code></pre>
</div>
</div>
<p>Looks like we have a lot of categorical features. Let’s make factorization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d0 <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">factor</span>(month, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"APR"</span>, <span class="st">"MAY"</span>, <span class="st">"JUN"</span>, <span class="st">"JUL"</span>, <span class="st">"AUG"</span>, <span class="st">"SEP"</span>, <span class="st">"OCT"</span>)),</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">day_of_week =</span> <span class="fu">factor</span>(day_of_week, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Monday"</span>, <span class="st">"Tuesday"</span>, <span class="st">"Wednesday"</span>, <span class="st">"Thursday"</span>, <span class="st">"Friday"</span>, <span class="st">"Saturday"</span>, <span class="st">"Sunday"</span>)),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">temp =</span> (temp<span class="dv">-32</span>)<span class="sc">*</span><span class="dv">5</span><span class="sc">/</span><span class="dv">9</span>) <span class="sc">%&gt;%</span> <span class="co"># in Celsius</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), factor),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">day =</span> <span class="fu">factor</span>(day, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">31</span>)), <span class="at">opponent =</span> <span class="fu">factor</span>(opponent))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> month         day         attend         day_of_week      opponent 
 APR:12   13     : 5   Min.   :24312   Monday   :12   Giants   : 9  
 MAY:18   15     : 5   1st Qu.:34493   Tuesday  :13   Padres   : 9  
 JUN: 9   30     : 5   Median :40284   Wednesday:12   Rockies  : 9  
 JUL:12   1      : 4   Mean   :41040   Thursday : 5   Snakes   : 9  
 AUG:15   3      : 4   3rd Qu.:46588   Friday   :13   Cardinals: 7  
 SEP:12   14     : 4   Max.   :56000   Saturday :13   Brewers  : 4  
 OCT: 3   (Other):54                   Sunday   :13   (Other)  :34  
      temp          skies    day_night   cap     shirt    fireworks bobblehead
 Min.   :12.22   Clear :62   Day  :15   NO :79   NO :78   NO :67    NO :70    
 1st Qu.:19.44   Cloudy:19   Night:66   YES: 2   YES: 3   YES:14    YES:11    
 Median :22.78                                                                
 Mean   :22.86                                                                
 3rd Qu.:26.11                                                                
 Max.   :35.00                                                                
                                                                              </code></pre>
</div>
</div>
<p>By looking the quarter values, the numeric valued data columns seems very balanced. Lets test it out.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span>attend, <span class="at">names=</span><span class="st">"Attend"</span> , <span class="at">col=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(d<span class="sc">$</span>temp, <span class="at">names=</span> <span class="st">"Temperature"</span>, <span class="at">col=</span><span class="st">"green"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Unfortunately, the same balance is not the case for the commercial products such as Cap, Shirt, Fireworks or bobblehead. So the confidence interval is expected to be higher when a prediction is done because the model is unable to fit with confidence by few points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(<span class="fu">summary</span>(d<span class="sc">$</span>cap),<span class="at">main =</span> <span class="st">"Cap"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(<span class="fu">summary</span>(d<span class="sc">$</span>shirt),<span class="at">main =</span> <span class="st">"Shirt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(<span class="fu">summary</span>(d<span class="sc">$</span>bobblehead),<span class="at">main =</span> <span class="st">"Bobblehead"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(<span class="fu">summary</span>(d<span class="sc">$</span>fireworks),<span class="at">main =</span> <span class="st">"Fireworks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>However, we can check the correlation between some of the categorical features and the attend feature. From this, we can infer that if any significant increase in attend occurred depending on the commercials or the weather. As it appears, people will likely to go to ball game in clear sky and summer months and there is a dependency between days of weeks, but there is no clear difference between day/night. In terms of commercials, people seem to be interested in shirt and bobblehead instead of cap.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(attend <span class="sc">~</span> skies, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(attend <span class="sc">~</span> day_night, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(attend <span class="sc">~</span> month, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(attend <span class="sc">~</span> bobblehead, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-6-4.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(attend <span class="sc">~</span> cap, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-6-5.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(attend <span class="sc">~</span> shirt, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-6-6.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(attend <span class="sc">~</span> opponent, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-6-7.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(attend <span class="sc">~</span> day_of_week, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-6-8.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(attend <span class="sc">~</span> fireworks, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-6-9.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(temp, attend)) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-6-10.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d, <span class="fu">aes</span>(day, attend)) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-6-11.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To see it mathematically, one can check the results of the anova test. Some may say that the shirt hypothesis could not be rejected but as the sample space decrease this test might not interpret truly so it needs further investigation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(attend <span class="sc">~</span> skies, <span class="at">data =</span> d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df    Sum Sq   Mean Sq F value Pr(&gt;F)
skies        1 1.255e+08 125525651   1.842  0.179
Residuals   79 5.382e+09  68131737               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(attend <span class="sc">~</span> day_night, <span class="at">data =</span> d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df    Sum Sq  Mean Sq F value Pr(&gt;F)
day_night    1 1.044e+07 10443460    0.15    0.7
Residuals   79 5.497e+09 69588474               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(attend <span class="sc">~</span> month, <span class="at">data =</span> d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df    Sum Sq   Mean Sq F value Pr(&gt;F)  
month        6 9.490e+08 158159686   2.567 0.0258 *
Residuals   74 4.559e+09  61607767                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(attend <span class="sc">~</span> bobblehead, <span class="at">data =</span> d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df    Sum Sq   Mean Sq F value   Pr(&gt;F)    
bobblehead   1 1.865e+09 1.865e+09   40.44 1.22e-08 ***
Residuals   79 3.643e+09 4.611e+07                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(attend <span class="sc">~</span> cap, <span class="at">data =</span> d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df    Sum Sq  Mean Sq F value Pr(&gt;F)
cap          1 1.666e+07 16662977    0.24  0.626
Residuals   79 5.491e+09 69509746               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(attend <span class="sc">~</span> shirt, <span class="at">data =</span> d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df    Sum Sq  Mean Sq F value Pr(&gt;F)
shirt        1 9.782e+07 97823856   1.428  0.236
Residuals   79 5.410e+09 68482393               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(attend <span class="sc">~</span> opponent, <span class="at">data =</span> d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df    Sum Sq  Mean Sq F value Pr(&gt;F)
opponent    16 1.410e+09 88109814   1.376  0.183
Residuals   64 4.098e+09 64033998               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(attend <span class="sc">~</span> day_of_week, <span class="at">data =</span> d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df    Sum Sq   Mean Sq F value  Pr(&gt;F)   
day_of_week  6 1.256e+09 209369992   3.644 0.00319 **
Residuals   74 4.252e+09  57455580                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(attend <span class="sc">~</span> shirt<span class="sc">+</span>bobblehead, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="feature-engineering" class="level2">
<h2 class="anchored" data-anchor-id="feature-engineering">Feature Engineering</h2>
<p>Lets look into what happens when I create a weekday and weekend feature. Actually this is not an improvement right now. But it could be because we had a skewed column in weekday_or_end.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weekday_or_end =</span> <span class="fu">ifelse</span>(day_of_week <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Saturday"</span>,<span class="st">"Sunday"</span>), <span class="st">"weekend"</span>, <span class="st">"weekday"</span>),</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">weekday_or_end =</span> <span class="fu">factor</span>(weekday_or_end))</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(attend <span class="sc">~</span> weekday_or_end, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(attend <span class="sc">~</span> weekday_or_end, <span class="at">data =</span> d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               Df    Sum Sq   Mean Sq F value Pr(&gt;F)
weekday_or_end  1 1.018e+08 101836320   1.488  0.226
Residuals      79 5.406e+09  68431602               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(d<span class="sc">$</span>weekday_or_end)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>weekday weekend 
     55      26 </code></pre>
</div>
</div>
<p>Looking into the “day” feature and the information on payment days might give some information. Maybe an additional feature might be created depending on the distance to the common payment days which are 15 and 30? Inference is that people might have the tendency to not go to the game depending on their money situation. When looking at the graph, the hypothesis is safely rejected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">distance_to_payment =</span> <span class="fu">pmin</span>(<span class="fu">abs</span>(<span class="fu">as.integer</span>(day) <span class="sc">-</span> <span class="dv">15</span>), <span class="fu">abs</span>(<span class="fu">as.integer</span>(day) <span class="sc">-</span> <span class="dv">30</span>)))</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(attend <span class="sc">~</span> distance_to_payment, <span class="at">data =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(attend <span class="sc">~</span> distance_to_payment, <span class="at">data =</span> d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Df    Sum Sq  Mean Sq F value Pr(&gt;F)
distance_to_payment  1 3.875e+07 38749397    0.56  0.457
Residuals           79 5.469e+09 69230171               </code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(d<span class="sc">$</span>distance_to_payment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.000   1.000   3.000   4.741   7.000  14.000 </code></pre>
</div>
</div>
<p>Because both of the features are not valuable, they are excluded.</p>
<p>Transformation is not a possible action because the quantitative features (temperature or) are not skewed.</p>
</section>
<section id="modeling-and-comparison" class="level2">
<h2 class="anchored" data-anchor-id="modeling-and-comparison">Modeling and Comparison</h2>
<p>Decision trees provide interpretability and can handle small datasets effectively, making them a suitable choice if interpretability is crucial. Neural networks is good at capturing complex patterns but may be prone to overfitting with small datasets, so they are not ideal in this case. Regression analysis, such as linear regression, is appropriate for datasets with straightforward relationships and offers interpretability, making it a good choice if I prefer a simple model. Ultimately, my decision is going to compare decision tree, linear regression, gradient boosting method and negative binomial regression. With experimentation across multiple algorithms, I will try to find the most suitable one for my specific dataset and objectives. For the</p>
<p>Let’s make our best model with linear regression. Trying out different alternatives, the best R2 value which is 0.6589 is given by this feature set.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>lmod <span class="ot">&lt;-</span> <span class="fu">lm</span>(attend <span class="sc">~</span> .<span class="sc">-</span>temp <span class="sc">-</span>opponent<span class="sc">-</span>skies , <span class="at">data =</span> d)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = attend ~ . - temp - opponent - skies, data = d)

Residuals:
   Min     1Q Median     3Q    Max 
 -9678  -1936    -46   2596   7424 

Coefficients: (2 not defined because of singularities)
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            29300.5     4952.3   5.917 1.23e-06 ***
monthMAY               -1541.6     2252.8  -0.684  0.49854    
monthJUN                7342.5     2563.0   2.865  0.00720 ** 
monthJUL                4114.8     2775.7   1.482  0.14770    
monthAUG                5043.6     2860.5   1.763  0.08712 .  
monthSEP                -732.2     2483.4  -0.295  0.76998    
monthOCT                2249.5     4075.6   0.552  0.58470    
day2                   -2260.0     4022.4  -0.562  0.57802    
day3                    2786.1     3775.5   0.738  0.46577    
day4                   -2215.8     5328.6  -0.416  0.68023    
day5                   17773.9     5159.4   3.445  0.00157 ** 
day6                   -4410.2     6123.4  -0.720  0.47646    
day7                    6850.3     4718.9   1.452  0.15604    
day8                   -2214.8     5130.3  -0.432  0.66876    
day9                    4620.3     6113.2   0.756  0.45513    
day10                  18828.8     7137.9   2.638  0.01263 *  
day11                   1471.9     4373.6   0.337  0.73859    
day12                  -4376.6     4372.9  -1.001  0.32418    
day13                   5443.0     3756.2   1.449  0.15676    
day14                   1159.8     3743.9   0.310  0.75868    
day15                   -527.5     3665.7  -0.144  0.88645    
day16                  -2630.5     4045.8  -0.650  0.52007    
day17                   8924.8     5288.7   1.688  0.10094    
day18                   7131.5     4975.7   1.433  0.16119    
day19                    380.7     6010.2   0.063  0.94988    
day20                   2415.8     5011.6   0.482  0.63297    
day21                   1447.5     6262.2   0.231  0.81863    
day22                   4215.1     6235.7   0.676  0.50378    
day23                  -5649.6     6208.0  -0.910  0.36939    
day24                   1521.7     5136.3   0.296  0.76889    
day25                  -2628.0     4175.7  -0.629  0.53345    
day26                  -1688.3     4712.6  -0.358  0.72243    
day27                   3010.1     4774.2   0.630  0.53272    
day28                   2770.0     3944.1   0.702  0.48741    
day29                   3683.6     3928.2   0.938  0.35520    
day30                   -776.2     3525.1  -0.220  0.82707    
day31                  -3450.8     4283.8  -0.806  0.42627    
day_of_weekTuesday      7870.7     3509.3   2.243  0.03174 *  
day_of_weekWednesday   -1111.3     2831.8  -0.392  0.69726    
day_of_weekThursday     2592.5     3481.0   0.745  0.46170    
day_of_weekFriday     -16946.5     7656.2  -2.213  0.03389 *  
day_of_weekSaturday     8518.4     2624.3   3.246  0.00269 ** 
day_of_weekSunday       8498.3     3780.5   2.248  0.03138 *  
day_nightNight          2725.1     3230.6   0.844  0.40500    
capYES                -15517.3     5682.5  -2.731  0.01006 *  
shirtYES                6886.7     3994.6   1.724  0.09406 .  
fireworksYES           20756.6     7043.4   2.947  0.00585 ** 
bobbleheadYES           9612.6     3106.6   3.094  0.00400 ** 
weekday_or_endweekend       NA         NA      NA       NA    
distance_to_payment         NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4846 on 33 degrees of freedom
Multiple R-squared:  0.8593,    Adjusted R-squared:  0.6589 
F-statistic: 4.287 on 47 and 33 DF,  p-value: 1.636e-05</code></pre>
</div>
</div>
<p>Now, we need to look for different models errors and interpretations depending on whether the bobblehead is promoted or not. First, train test split is done</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Train/test split (85% train, 20% test)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(d), <span class="fl">0.85</span> <span class="sc">*</span> <span class="fu">nrow</span>(d))</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">&lt;-</span> d[indices, ]</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> d[<span class="sc">-</span>indices, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Linear model is built</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the linear regression model</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>lm_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(attend <span class="sc">~</span> .<span class="sc">-</span>temp <span class="sc">-</span>opponent<span class="sc">-</span>skies, <span class="at">data =</span> train_data)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_model, <span class="at">newdata =</span> test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in predict.lm(lm_model, newdata = test_data): prediction from a
rank-deficient fit may be misleading</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate accuracy (for regression, you typically use metrics like mean absolute error, mean squared error, etc.)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> test_data<span class="sc">$</span>attend))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> test_data<span class="sc">$</span>attend)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>mape <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> test_data<span class="sc">$</span>attend)<span class="sc">/</span>test_data<span class="sc">$</span>attend)</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Mean Absolute Error:"</span>, mae))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean Absolute Error: 6682.73345444161"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Mean Squared Error:"</span>, mse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean Squared Error: 72560690.4035707"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Mean Absolute Percentage Error:"</span>, mape))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean Absolute Percentage Error: 0.154396655161064"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = attend ~ . - temp - opponent - skies, data = train_data)

Residuals:
   Min     1Q Median     3Q    Max 
 -7459  -1349      0   1285   8010 

Coefficients: (2 not defined because of singularities)
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)            30299.3     5944.6   5.097  5.5e-05 ***
monthMAY                -843.4     2530.2  -0.333  0.74235    
monthJUN                8611.9     2587.0   3.329  0.00335 ** 
monthJUL                5574.5     2933.7   1.900  0.07192 .  
monthAUG                4196.4     3295.8   1.273  0.21752    
monthSEP               -2360.5     3433.4  -0.688  0.49966    
monthOCT                1353.4     4240.3   0.319  0.75289    
day2                   -3289.0     4351.5  -0.756  0.45855    
day3                    2752.6     4215.3   0.653  0.52119    
day4                    2278.5     6440.0   0.354  0.72719    
day5                   18549.4     5639.8   3.289  0.00367 ** 
day6                   -3332.5     6514.9  -0.512  0.61459    
day7                    -209.6     7570.5  -0.028  0.97819    
day8                   -4131.0     5919.4  -0.698  0.49329    
day9                    2226.2     6871.0   0.324  0.74931    
day10                  15314.0     7831.1   1.956  0.06464 .  
day11                   -795.5     5296.2  -0.150  0.88211    
day12                  -3938.1     4944.0  -0.797  0.43507    
day13                   2061.1     4888.4   0.422  0.67779    
day14                  -3584.4     5058.6  -0.709  0.48677    
day15                  -4157.1     5504.1  -0.755  0.45889    
day16                  -3476.0     4569.9  -0.761  0.45575    
day17                   5369.0     6161.2   0.871  0.39387    
day18                   4750.0     6572.1   0.723  0.47820    
day19                    113.3     6093.2   0.019  0.98535    
day20                   2171.7     6852.9   0.317  0.75461    
day21                    766.4     7570.5   0.101  0.92037    
day22                   3366.4     7091.2   0.475  0.64012    
day23                  -5419.1     6372.4  -0.850  0.40517    
day24                    220.7     5798.6   0.038  0.97001    
day25                  -3387.9     4878.5  -0.694  0.49539    
day26                  -2447.0     5185.3  -0.472  0.64211    
day27                   1030.6     5503.1   0.187  0.85333    
day28                   4033.2     4589.2   0.879  0.38991    
day29                   1619.9     5481.3   0.296  0.77063    
day30                  -3059.0     4909.0  -0.623  0.54024    
day31                  -3324.9     5172.0  -0.643  0.52761    
day_of_weekTuesday     10386.7     3695.8   2.810  0.01080 *  
day_of_weekWednesday     815.1     3189.7   0.256  0.80091    
day_of_weekThursday    -1557.5     3840.5  -0.406  0.68939    
day_of_weekFriday      -7902.5     8636.9  -0.915  0.37111    
day_of_weekSaturday     8318.0     2813.5   2.957  0.00780 ** 
day_of_weekSunday       9596.5     5711.2   1.680  0.10846    
day_nightNight          1495.8     5696.7   0.263  0.79557    
capYES                -18385.8     5988.1  -3.070  0.00604 ** 
shirtYES                9092.4     5036.5   1.805  0.08610 .  
fireworksYES           13106.8     7762.5   1.688  0.10685    
bobbleheadYES           8855.4     3676.7   2.409  0.02578 *  
weekday_or_endweekend       NA         NA      NA       NA    
distance_to_payment         NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4474 on 20 degrees of freedom
Multiple R-squared:  0.9161,    Adjusted R-squared:  0.7188 
F-statistic: 4.644 on 47 and 20 DF,  p-value: 0.0002288</code></pre>
</div>
</div>
<p>When we look into the coefficients of the variables(boobleheadYES), one might say that promoting bobbleheads make a positive difference of approximately 8855 attendance with an error percentage of %15,5.</p>
<p>Random Forest model is built</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the random forest model</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(attend <span class="sc">~</span> .<span class="sc">-</span>temp <span class="sc">-</span>opponent <span class="sc">-</span>skies, <span class="at">data =</span> train_data, <span class="at">mtry =</span> <span class="dv">9</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata =</span> test_data)</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean absolute error (MAE) and mean squared error (MSE) for evaluation</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> test_data<span class="sc">$</span>attend))</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> test_data<span class="sc">$</span>attend)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>mape <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> test_data<span class="sc">$</span>attend)<span class="sc">/</span>test_data<span class="sc">$</span>attend)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Mean Absolute Error:"</span>, mae))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean Absolute Error: 5136.58622307692"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Mean Squared Error:"</span>, mse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean Squared Error: 38847907.8889538"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Mean Absolute Percentage Error:"</span>, mape))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean Absolute Percentage Error: 0.123516116394811"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot variable importance</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">varImpPlot</span>(rf_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Hyper-parameter Tuning</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the total number of predictors</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>total_predictors <span class="ot">&lt;-</span> <span class="fu">ncol</span>(train_data) <span class="sc">-</span> <span class="dv">3</span>  <span class="co"># Excluding 'temp', 'opponent', and 'skies' columns</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the parameter grid with valid values of mtry</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">mtry =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>total_predictors))</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the train control</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Train the random forest model using different parameters</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>  attend <span class="sc">~</span> .<span class="sc">-</span>temp <span class="sc">-</span>opponent <span class="sc">-</span>skies, </span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> train_data,</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> ctrl,</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneGrid =</span> param_grid</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata =</span> test_data)</span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>rf_model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest 

68 samples
13 predictors

No pre-processing
Resampling: Cross-Validated (5 fold) 
Summary of sample sizes: 55, 55, 54, 54, 54 
Resampling results across tuning parameters:

  mtry  RMSE      Rsquared   MAE     
   1    8027.390  0.3400456  6778.787
   2    7423.144  0.4146919  6299.186
   3    7140.693  0.3896161  5994.119
   4    6907.295  0.4076861  5766.748
   5    6724.658  0.4322824  5541.131
   6    6691.062  0.4176241  5504.963
   7    6534.542  0.4484220  5331.396
   8    6525.920  0.4379610  5257.923
   9    6421.768  0.4559395  5172.104
  10    6443.122  0.4543992  5152.038
  11    6456.032  0.4383673  5112.528

RMSE was used to select the optimal model using the smallest value.
The final value used for the model was mtry = 9.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(rf_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the random forest model</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>rf_model <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(attend <span class="sc">~</span> .<span class="sc">-</span>temp <span class="sc">-</span>opponent<span class="sc">-</span>skies, <span class="at">data =</span> train_data, <span class="at">mtry=</span><span class="dv">9</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set with the bobblehead feature</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>predictions_with_bobblehead <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata =</span> test_data)</span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the bobblehead feature to the test data with value 1</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>test_data_bobblehead <span class="ot">&lt;-</span> test_data</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>test_data_bobblehead<span class="sc">$</span>bobblehead <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="st">"YES"</span>)</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set with the bobblehead feature set to 1</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>predictions_with_bobblehead_1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(rf_model, <span class="at">newdata =</span> test_data_bobblehead <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">bobblehead =</span> <span class="fu">factor</span>(bobblehead , <span class="at">levels=</span> <span class="fu">c</span>(<span class="st">"YES"</span>,<span class="st">"NO"</span>) )))</span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the increase in attendance</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>increase_in_attendance <span class="ot">&lt;-</span> <span class="fu">mean</span>(predictions_with_bobblehead_1 <span class="sc">-</span> predictions_with_bobblehead)</span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Average increase in attendance when bobblehead feature becomes YES:"</span>, increase_in_attendance))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Average increase in attendance when bobblehead feature becomes YES: 4271.39264102564"</code></pre>
</div>
</div>
<p>When we look into the coefficients of the variables(boobleheadYES), one might say that promoting bobbleheads make a positive difference of approximately 4041 attendance with an error percentage of %12,9.</p>
<p>Gradient Boosting Model</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the gradient boosting model</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>gbm_model <span class="ot">&lt;-</span> <span class="fu">gbm</span>(attend <span class="sc">~</span> .<span class="sc">-</span>temp <span class="sc">-</span>opponent<span class="sc">-</span>skies, <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">"gaussian"</span>, <span class="at">n.trees =</span> <span class="dv">1000</span>, <span class="at">interaction.depth =</span> <span class="dv">4</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(gbm_model, <span class="at">newdata =</span> test_data, <span class="at">n.trees =</span> <span class="dv">1000</span>)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate mean absolute error (MAE) and mean squared error (MSE) for evaluation</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> test_data<span class="sc">$</span>attend))</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>mse <span class="ot">&lt;-</span> <span class="fu">mean</span>((predictions <span class="sc">-</span> test_data<span class="sc">$</span>attend)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>mape <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(predictions <span class="sc">-</span> test_data<span class="sc">$</span>attend)<span class="sc">/</span>test_data<span class="sc">$</span>attend)</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Mean Absolute Error:"</span>, mae))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean Absolute Error: 7701.42848220009"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Mean Squared Error:"</span>, mse))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean Squared Error: 98506787.2121607"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Mean Absolute Percentage Error:"</span>, mape))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Mean Absolute Percentage Error: 0.167565375301425"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gbm_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="GE-461-Project-1_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>                                    var      rel.inf
day                                 day 73.219025879
month                             month 13.830957861
day_of_week                 day_of_week 12.853991191
distance_to_payment distance_to_payment  0.093436048
weekday_or_end           weekday_or_end  0.002589021
day_night                     day_night  0.000000000
cap                                 cap  0.000000000
shirt                             shirt  0.000000000
fireworks                     fireworks  0.000000000
bobblehead                   bobblehead  0.000000000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>gbm_model <span class="ot">&lt;-</span> <span class="fu">gbm</span>(attend <span class="sc">~</span> .<span class="sc">-</span>temp <span class="sc">-</span>opponent<span class="sc">-</span>skies, <span class="at">data =</span> train_data, <span class="at">distribution =</span> <span class="st">"gaussian"</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set with the bobblehead feature</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>predictions_with_bobblehead <span class="ot">&lt;-</span> <span class="fu">predict</span>(gbm_model, <span class="at">newdata =</span> test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using 100 trees...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the bobblehead feature to the test data with value 1</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>test_data_bobblehead <span class="ot">&lt;-</span> test_data</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>test_data_bobblehead<span class="sc">$</span>bobblehead <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="st">"YES"</span>)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the test set with the bobblehead feature set to 1</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>predictions_with_bobblehead_1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(gbm_model, <span class="at">newdata =</span> test_data_bobblehead )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Using 100 trees...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the increase in attendance</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>increase_in_attendance <span class="ot">&lt;-</span> <span class="fu">mean</span>(predictions_with_bobblehead_1 <span class="sc">-</span> predictions_with_bobblehead)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Average increase in attendance when bobblehead feature becomes YES:"</span>, increase_in_attendance))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Average increase in attendance when bobblehead feature becomes YES: 0"</code></pre>
</div>
</div>
<p>It appears that gradient boosting model does not give any importance to bobblehead feature because there is no difference between. And its error percentage is 16,3%. However, it is not a good model for our interpretation.</p>
<p>According to the case, we are making our decision for 2013. By looking at the ticket prices, it varies from 20 dollars(top deck) to 120 dollars(VIP field). Looking at the average price it is approximately 50$/seat. Considering the 56000 available seat, we can conclude that ,with the promotion, our additional profit would be 442750 dollars according to linear regression. Besides, according to the promotion procedure we need to buy and distribute 50000 bobbleheads which sums up to 150000 dollars as cost. On the other hand, according to the results of the random forest model, we sell approximately 4041 tickets which results in 202050 dollars profit and 150000 dollars of cost. Either way, according to data analysis, it sounds profitable in the short run.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>